<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../assets/icons/favicon.ico" type="image/x-icon">
    <title>Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../../js/funcoesAdm.js"></script>
    <script src="../../js/funcoes.js"></script>

    <link rel="stylesheet" href="../../global.css">
    <link rel="stylesheet" href="style.css">
</head>

<body onload="validarSessao(),listarPiratasTabela(),listarBando()">
    <header class="header-profile">
        <div class="wrapper">

            <div class="container-header">
                <div class="logo">
                    <!-- <img src="../../assets/icons/logo.png" alt="" /> -->
                    <h2>The Crew</h2>
                </div>
                <div class="nav">
                    <ul>
                        <li>
                            <div class="user-profile">
                                <img class="img-profile" src="../../assets/icons/jollyroger-heart.png" alt="">
                                <div class="profile-content">
                                    <h3 id="nomeProfile"></h3>
                                </div>

                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </header>
    <main class="container-main">
        <div class="side-menu">
            <ul class="menu">
                <li><a href="dashboard.html"> <svg width="76" height="84" viewBox="0 0 76 84" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M8.83333 83.6667H67.1667C69.3768 83.6667 71.4964 82.7887 73.0592 81.2259C74.622 79.6631 75.5 77.5435 75.5 75.3333V37.8333C75.5032 37.285 75.3981 36.7414 75.1907 36.2337C74.9834 35.7261 74.6778 35.2643 74.2917 34.875L40.9583 1.54167C40.1777 0.765623 39.1216 0.330032 38.0208 0.330032C36.9201 0.330032 35.864 0.765623 35.0833 1.54167L1.75 34.875C1.3563 35.2609 1.04309 35.7211 0.828522 36.2289C0.613953 36.7367 0.502289 37.2821 0.5 37.8333V75.3333C0.5 77.5435 1.37797 79.6631 2.94078 81.2259C4.50358 82.7887 6.6232 83.6667 8.83333 83.6667ZM29.6667 75.3333V54.5H46.3333V75.3333H29.6667ZM8.83333 39.5417L38 10.375L67.1667 39.5417V75.3333H54.6667V54.5C54.6667 52.2899 53.7887 50.1702 52.2259 48.6074C50.6631 47.0446 48.5435 46.1667 46.3333 46.1667H29.6667C27.4565 46.1667 25.3369 47.0446 23.7741 48.6074C22.2113 50.1702 21.3333 52.2899 21.3333 54.5V75.3333H8.83333V39.5417Z"
                                fill="black" />
                        </svg></a>
                    <span>
                        Home
                    </span>

                </li>
                <li><a onclick="limparSessao()"> <svg width="75" height="76" viewBox="0 0 75 76" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M48.75 75.5C49.7446 75.5 50.6984 75.1049 51.4016 74.4017C52.1049 73.6984 52.5 72.7446 52.5 71.75C52.5 70.7554 52.1049 69.8016 51.4016 69.0983C50.6984 68.3951 49.7446 68 48.75 68H17.5C14.8478 68 12.3043 66.9464 10.4289 65.0711C8.55357 63.1957 7.5 60.6522 7.5 58V18C7.5 15.3478 8.55357 12.8043 10.4289 10.9289C12.3043 9.05357 14.8478 8 17.5 8H48.75C49.7446 8 50.6984 7.60491 51.4016 6.90165C52.1049 6.19839 52.5 5.24456 52.5 4.25C52.5 3.25544 52.1049 2.30161 51.4016 1.59835C50.6984 0.895088 49.7446 0.5 48.75 0.5H17.5C12.8587 0.5 8.40752 2.34374 5.12563 5.62563C1.84375 8.90752 0 13.3587 0 18V58C0 62.6413 1.84375 67.0925 5.12563 70.3744C8.40752 73.6563 12.8587 75.5 17.5 75.5H48.75ZM53.705 18.995C54.0668 18.6607 54.4908 18.401 54.953 18.2306C55.4151 18.0602 55.9063 17.9826 56.3985 18.0021C56.8907 18.0216 57.3742 18.1379 57.8214 18.3443C58.2686 18.5507 58.6708 18.8431 59.005 19.205L74.005 35.455C74.6453 36.1479 75.0008 37.0566 75.0008 38C75.0008 38.9434 74.6453 39.8521 74.005 40.545L59.005 56.795C58.3294 57.525 57.3914 57.9567 56.3975 57.9952C55.4035 58.0336 54.435 57.6756 53.705 57C52.975 56.3244 52.5433 55.3864 52.5048 54.3925C52.4664 53.3985 52.8244 52.43 53.5 51.7L62.69 41.745H23.75C22.7554 41.745 21.8016 41.3499 21.0983 40.6467C20.3951 39.9434 20 38.9896 20 37.995C20 37.0004 20.3951 36.0466 21.0983 35.3433C21.8016 34.6401 22.7554 34.245 23.75 34.245H62.685L53.495 24.29C53.1607 23.9282 52.901 23.5042 52.7306 23.042C52.5602 22.5799 52.4826 22.0887 52.5021 21.5965C52.5216 21.1043 52.6379 20.6208 52.8443 20.1736C53.0507 19.7264 53.3431 19.3242 53.705 18.99V18.995Z"
                                fill="black" />
                        </svg></a>
                    <span>
                        Sair
                    </span>

                </li>
            </ul>
        </div>

        <div class="container-home">
            <div class="container-card">
                <div class="container-grafico">
                    <h1>Gráfico</h1>
                    <canvas id="myChart" style="height: 100%;
                    width: 100%;"></canvas>
                </div>
                <div class="header-container-colecao">
                    <div class="header-title">
                        <h1>Visualizar Cartas.</h1>
                        <!-- <button class="btn btn-blue" id="btnOpen">Mostrar Cartas</button> -->
                    </div>

                    <div class="container-filtros filtros-active">
                        <p>Total: <span id="countRegistro"></span> </p>
                        <div>
                            <select class="selectFiltro" id="selectFiltro" onchange="escolherPirataTabela()">
                                <option value="*">Todos</option>
                                <option value="1">Chapéu de Palha</option>
                                <option value="2">Piratas Heart</option>
                                <option value="3">Marinha</option>
                                <option value="4">Big Mom</option>
                            </select>

                        </div>
                    </div>
                </div>
                <div class="container-colecao-cards colecao-cards-active">

                    <table class="table-piratas">
                        <thead>
                            <tr>
                                <th>Carta</th>
                                <th>Nome Pirata</th>
                                <th>Bando</th>

                            </tr>
                        </thead>
                        <tbody id="tabelaCartas">


                        </tbody>
                    </table>
                </div>
            </div>
        </div>



    </main>
</body>

</html>
<script>
    var btn = document.getElementById('btnOpen')
    btn.addEventListener('click', () => {
        var filtro = document.querySelector('container-filtros')
        filtro.classList.toggle('filtros-active')
    })

    document.title = sessionStorage.NOME_USUARIO + ' - Dashboard'
    function listarBando() {

        fetch('/piratas/listarBando').then(function (resposta) {
            if (resposta.ok) {
                resposta.json().then(function (resposta) {
                    const labels = [

                    ]
                    const dados = {
                        labels: labels,
                        datasets: [{
                            label: 'Bandos',
                            data: [],
                            backgroundColor: [
                                '#E3454F',
                                '#E8C130',
                                '#1868B7',
                                '#D8566B'
                            ]
                        }]
                    };
                    for (var i = 0; i < resposta.length; i++) {
                        var item = resposta[i];


                        if (item.nomeBando == 'Chapéu de Palha') {
                            dados.datasets[0].data.push(item.qtdAdicoes);
                            labels.push(item.nomeBando);
                            
                        } else if (item.nomeBando == 'Piratas Heart') {
                            dados.datasets[0].data.push(item.qtdAdicoes);
                            dados.labels.push(item.nomeBando);
                        } else if (item.nomeBando == 'Marinha') {
                            dados.datasets[0].data.push(item.qtdAdicoes);
                            dados.labels.push(item.nomeBando);
                        } else if (item.nomeBando == 'Piratas Big Mom') {
                            dados.datasets[0].data.push(item.qtdAdicoes);
                            dados.labels.push(item.nomeBando);
                        }
                    }
                    const config = {
                        type: 'bar',
                        data: dados,
                        options: {}
                    };

                    const myChart = new Chart(
                        document.getElementById('myChart'),
                        config
                    );
                    console.log('Dados:', JSON.stringify(resposta))

                })
            }


        })

    }


</script>